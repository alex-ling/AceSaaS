(function(n){function r(t){var u=t.id,s=n(t).parent(),f=n.data(t,"uploadbox"),e=n.extend({browse_button:"btn_"+u},f.options),o=AX.format('<div id="btn_{0}" class="weui-uploader__input-box"><\/div>',u),r;n(o).insertAfter(t);r=new plupload.Uploader(e);f.options._uploader=r;r._opts=e;r._box=n(t);r._container=n(t).parent();r._files=n(t).closest(".weui-uploader").find(".weui-uploader__files");r._gallery=n(t).closest(".weui-cells").find(".weui-gallery");r._numbox=n(t).closest(".weui-uploader").find(".num");r._files.on("click","li",function(){r._index=n(this).index();r._gallery.find(".weui-gallery__img").attr("style",this.getAttribute("style"));r._gallery.fadeIn(100)});r._files.on("click",".close",function(t){t.stopPropagation();r._index=n(this).parent().index();var u=r._files.find("li").eq(r._index).attr("id");i(r,r.getFile(u))});r._gallery.on("click",function(){r._gallery.fadeOut(100)});r._gallery.find(".weui-gallery__del").click(function(){var n=r._files.find("li").eq(r._index).attr("id");i(r,r.getFile(n))});r.init()}function u(n){var t=AX.tick();return(!n.params||n.params.expire<t+3)&&AX.ajax({url:AX.api({api:"aliyun/getosssign"}),data:{bucket:n._opts.bucket,dir:n._opts.dir},type:"get","async":!1,cb:function(t){n.params=t.value}}),n.params}function e(t,i){var r=new moxie.file.FileReader;r.onload=function(){var u=AX.format('<li id="{0}" class="weui-uploader__file weui-uploader__file_status" style="background-image:url({1})">                <div class="close">X<\/div>                <div class="weui-uploader__file-content">0%<\/div>            <\/li>',i.id,r.result);t._files.append(n(u));r.destroy();f=null};r.readAsDataURL(i.getSource())}function i(n,i){i&&(i.url?n._opts.bucket?AX.ajax({url:AX.api({api:"aliyun/delossfile"}),data:{bucket:n._opts.bucket,key:i.ossName},type:"delete",cb:function(){n._box.val(n._box.val().replace(","+i.url,""));t(n,i)}}):n._opts.dir&&AX.ajax({url:AX.api({api:"file/delfile"}),data:{file:i.url},type:"delete",cb:function(){n._box.val(n._box.val().replace(","+i.url,""));t(n,i)}}):t(n,i))}function t(n,t){n.removeFile(t);n._files.find("li").eq(n._index).remove()}n.fn.uploadbox=function(t,i){return typeof t=="string"?n.fn.uploadbox.methods[t](this,i):(t=t||{},this.each(function(){var i=n.data(this,"uploadbox");i?n.extend(i.options,t):i=n.data(this,"uploadbox",{options:n.extend({},n.fn.uploadbox.defaults,t)});r(this)}))};n.fn.uploadbox.methods={options:function(t){return n.data(t[0],"uploadbox").options},start:function(t){var i=n.data(t[0],"uploadbox").options;i._uploader.start()},count:function(t){var i=n.data(t[0],"uploadbox").options;return i._uploader.files.length},fadeout:function(t){var i=n.data(t[0],"uploadbox").options;i._uploader._gallery.fadeOut(100)}};n.fn.uploadbox.defaults={url:"http://oss.aliyuncs.com",runtimes:"html5,flash,silverlight,html4",multi_selection:!0,flash_swf_url:"plupload/js/Moxie.swf",silverlight_xap_url:"plupload/js/Moxie.xap",multipart:!0,autoUpload:!0,max_retries:0,beforeUpload:function(){},uploaded:function(){},filters:{mime_types:[{title:"图片文件",extensions:"jpg,jpeg,gif,png,bmp"},{title:"办公文档",extensions:"doc,docx,xls,xlsx,ppt,pptx,pdf,txt"},{title:"压缩文件",extensions:"zip,rar"}],max_file_size:"20mb",prevent_duplicates:!0},init:{PostInit:function(){for(var i=this._box.val().split(","),t=1;t<i.length;t++){var n=i[t],u=AX.filename(n).substr(11),r=n;n.substr(0,4)=="http"&&(r=n.substr(n.indexOf("/",10)+1));createProgress(this,{id:t,name:u,ossName:r,url:n,size:0,percent:100})}},FilesAdded:function(n,t){var r=n.files.length-t.length,i=!1;plupload.each(t,function(t){r++<n._opts.max?e(n,t):(i=!0,n.removeFile(t))});i&&AX.wxWarn("最多能上传"+n._opts.max+"个文件！");n.files.length==n._opts.max&&n._container.hide();n._numbox.text(n.files.length);n._opts.autoUpload&&setTimeout(function(){n.start()},100)},FilesRemoved:function(n){n.files.length<n._opts.max&&n._container.show();n._numbox.text(n.files.length)},BeforeUpload:function(n,t){var i,r;n._opts.bucket?(i=u(n),t.ossName=i.dir+"/"+AX.tick()+"_"+t.name,t.url=i.host+"/"+t.ossName,r={key:t.ossName,policy:i.policy,OSSAccessKeyId:i.accessid,success_action_status:"200",callback:i.callback,signature:i.signature},n.setOption({url:i.host,multipart_params:r})):(n._opts.dir&&(t.fileName=n._opts.dir+"/"+AX.tick()+"_"+t.name,t.url="/upload/"+t.fileName),n._opts.beforeUpload&&n._opts.beforeUpload.call(n))},UploadProgress:function(t,i){n("#"+i.id).find(".weui-uploader__file-content").text(i.percent+"%")},FileUploaded:function(n,t,i){i.status==200?n._opts.dir&&n._box.val(n._box.val()+","+t.url):i.status==203},UploadComplete:function(n){n._opts.uploaded&&n._opts.uploaded.call()},Error:function(n,t){t.code==-600?AX.wxWarn("选择的文件太大了！"):t.code==-601?AX.wxWarn("选择的文件后缀不对！"):t.code==-602?AX.wxWarn("这个文件已经上传!"):AX.wxWarn("发生错误:"+t.response)}}}})(jQuery),function(n){var t={opts:{w:750,h:450,url:n.location.href,maxW:$(n.top).width(),maxH:$(n.top).height(),dialogMode:!0,_loading:!1,_modified:!1,_curTreeId:null,_uploadedFiles:[],_curMods:[]},init:function(n){n=n||{};this.opts=$.extend(this.opts,n);AX.root=n.root||"/"},modify:function(){t.opts._modified=!0},wxRun:function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("micromessenger")!=-1},query:function(t,i){var e,h,o,r,u,s,f;if(typeof i=="undefined"?i=n.location.search:(e=i.indexOf("?"),e>0&&(i=i.substr(e))),typeof t!="undefined")return(h=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),o=i.substr(1).match(h),o!=null)?unescape(o[2]):null;for(r=[],s=i.substr(1).split("&"),f=0;f<s.length;f++)u=s[f].split("="),r.push(u[0]),r[u[0]]=u[1];return r},close:function(){n.open("","_self","");n.close()},refresh:function(){n.location=n.location},index:function(){n.location=t.opts.app=="app"?t.opts.root+"app":t.opts.root},login:function(){n.location=t.format("{0}?app={1}",t.opts.loginUrl,t.opts.app)},enter:function(){n.location=t.format("{0}plat/account/enter?app={1}",t.opts.root,t.opts.app)},logout:function(){n.location=t.format("{0}?app={1}",t.opts.logoutUrl,t.opts.app)},tfocus:function(){var n=$("input:text,input:password").not(":hidden");n.bind("keydown",function(t){if(t.which==13){t.preventDefault();var i=n.index(this)+1;i<n.length?n[i].focus():login()}})},path:function(n){return AX.opts.path+n},app:function(n){return t.format("{0}{1}/{2}",t.opts.root,t.opts.app,n)},load:function(n){n.substr(0,1)!="/"&&(n=t.path(n));$(".ct-wrap").find("iframe").attr("src",n)},go:function(n){var t=n.indexOf("|"),i,r=t>0?n.substr(0,t):n;$("[data-url='"+r+"']").trigger("click");n=n.substr(t+1);i=n.split("/");$("[data-url='"+r+"/"+i[0]+"']").trigger("click");i.length>1&&AX.load("/"+r+"/"+n)},gourl:function(t){n.location=t.substr(0,1)=="/"?t:AX.app(t)},initFt:function(){$(".ct-title").append('<button class="fr btn btn-default btn-xs ml20 mt5" onclick="AX.refresh()"><span class="fa fa-refresh"><\/span> 刷新<\/button>');$(".ct-wrap .btn[data-cmd]").click(function(){var n=$(this).attr("data-cmd");n=="reload"?AX.refresh():n=="save"?onSubmit(AX.ok):n=="save-back"&&onSubmit(function(){AX.ok();AX.gourl($(this).attr("data-url"))})})},initBk:function(){$(".ct-title").append('<button class="fr btn btn-default btn-xs ml10 mt8" data-cmd="max"><span class="fa fa-window-maximize"><\/span> 全屏打开<\/button>');$(".ct-title").append('<button class="fr btn btn-default btn-xs ml20 mt8" data-cmd="reload"><span class="fa fa-refresh"><\/span> 刷新<\/button>');$(".ct-wrap .btn[data-cmd]").click(function(){var n=$(this).attr("data-cmd");n=="reload"?AX.reload():n=="max"?window.open(window.location.href.replace("&nav=1","")):n=="back"?AX.back():n=="save"?onSubmit(AX.ok):n=="save-back"&&onSubmit(function(){AX.ok();n.indexOf("back")>=0&&AX.back()})})},back:function(){n.history.back()},reload:function(){AX.refresh()},onLogin:function(){AX.formSubmit("#log",function(n){$.messager.info({msg:"登录成功"});window.location=n})},formSubmit:function(n,i,r,u){var e=$(n),s,o,f;if(e.length!=0&&(typeof i=="undefined"&&(i=null),$(".aceui-kindeditor").kindeditor("sync"),e.form("validate"))){for(s=function(){var n=e.data("form"),o=n.options.url,s=e.serializeObject(),f=n.options.isEdit?$.extend(s,{id:n.data.id}):$.extend(n.data,s);r&&(o+="&"+r);u&&(f=$.extend(f,u));t.ajax($.extend({},n.options,{url:o,cb:i,data:f,headers:{RequestVerificationToken:f.__RequestVerificationToken}}))},o=0;o<AX.opts._uploadedFiles.length;o++){if(f=AX.opts._uploadedFiles[o],f.settings.required&&f.settings.target.val()==""&&f.getStats().files_queued==0)return $.messager.error({msg:"请选择要上传的文件！"}),!1;if(f.getStats().files_queued>0)return f.settings.onComplete=s,f.startUpload(),!1}s()}},formReset:function(n){var t=$(n);t.length!=0&&t.form("reset")},formLoad:function(n,i){$(n).data("form").data=i;t._loading=!0;$(n).form("load",i);typeof onLoad=="function"&&onLoad(i);t._loading=!1},formExport:function(n,i){var r=$(t.format('<form action="{0}" method="post"><\/form>',n));i&&$.each(i,function(n,i){r.append($(t.format('<input type="hidden" name="{0}" value="{1}">',n,i)))});$(r).appendTo("body").submit().remove()},selShow:function(){var i=$(this),n=i.combo("options"),r=n.url,u;return n.parent&&(r=t.aurl(r,n.param,$("#"+n.parent).combo("getValue"))),u=n.multiple?i.combo("getValues")+"&multi=1":i.combo("getValue"),t.dialog("请选择",t.aurl(r,"val",u),function(t,r){if(n.onSelect&&n.onSelect.call(i,t,r)==!1)return!0;i.combo("setValue",t);i.combo("setText",r)},n.panelWidth,n.panelHeight),!1},btnShow:function(){var i=$(this),n=i.linkbutton("options"),r=$(n.valBox),u=$(n.txtBox),f=r.textbox("getValue");return t.dialog("请选择",t.aurl(n.url,"val",f),function(t,f){if(n.onSelect&&n.onSelect.call(i,t,f)==!1)return!0;r.textbox("setValue",t);u.textbox("setValue",f);n.onChange&&n.onChange.call(i,t,f)},n.dialogWidth||t.opts.w,n.dialogHeight||t.opts.h),!1},lstShow:function(){var i=$(this),n=i.listbox("options"),r=t.aurl(n.url,"multi","1");return t.dialog("请选择",t.aurl(r,"val",i.val()),function(t){if(n.onSelect&&n.onSelect.call(i,t)==!1)return!0;i.listbox("setValues",t)},n.dialogWidth||t.opts.w,n.dialogHeight||t.opts.h),!1},selText:function(n){$(this).combo("setText",n)},treeAdd:function(n,t,i){var r={level:t};i&&(r.editUrl=i);$(n).tree("add",r)},treeEdit:function(n,t,i){var r={level:t};i&&(r.editUrl=i);$(n).tree("edit",r)},treeDel:function(n,t,i){var r={level:t,ds:i};$(n).tree("del",r)},gridSrh:function(n,t){var r,i=$(n),u=$(t);i.hasClass("easyui-datagrid")?(r=$.extend(i.datagrid("options").queryParams,u.serializeObject()),i.datagrid("load",r)):(r=$.extend(i.treegrid("options").queryParams,u.serializeObject()),i.treegrid("load",r))},gridClr:function(n,i){t.formReset(i);t.gridSrh(n,i)},gridEx:function(n){var r=$(n),i=r.hasClass("easyui-datagrid")?r.datagrid("options"):r.datagrid("options"),u=i.url.split("?").length>1?i.url.split("?")[1]:"",o=$.param(i.queryParams),f,e;o&&(u+="&"+$.param(i.queryParams));f=t.api({api:"excel/down",q:u+"&path="+t.opts.path});e=t.format('<form action="{0}" method="post"><\/form>',AX.aurl(f,"rows","0"));$(e).appendTo("body").submit().remove()},gridTb:function(n){var t=typeof n=="string"?$(n):n,i=[{iconCls:"icon-excel",text:"&nbsp;导出Excel文件",handler:function(){AX.gridEx(n)}}];t.hasClass("easyui-datagrid")?t.datagrid("getPager").pagination({buttons:i}):t.treegrid("getPager").pagination({buttons:i})},gridAdd:function(n,i,r){var u=AX.query("taskid");r&&u&&(i=i?t.aurl(i,"taskid",u,!0):"taskid="+u);$(n).hasClass("easyui-datagrid")?$(n).datagrid("add",i):$(n).treegrid("add",i)},gridEdit:function(n,t){$(n).hasClass("easyui-datagrid")?$(n).datagrid("edit",t):$(n).treegrid("edit",t)},gridDel:function(n,t){$(n).hasClass("easyui-datagrid")?$(n).datagrid("del",t):$(n).treegrid("del",t)},gridWf:function(n,i){var r=t.query("taskid");AX.dialog("查看流程","/plat/wf/track?appinstanceid="+i+"&taskid="+r,onWf,800,500)},gridAct:function(n,i,r){i=="del"?t.gridDel(n,r):i=="edit"?t.gridEdit(n,r):i=="wf"?t.gridWf(n,r):new Function(t.format('event_{0}_{1}("{2}","{3}");',n.substr(1),i,n,r))()},gridFmt:function(n,i){var b=this.format.split(":")[0],u,f,c,l,e,a,h,v,p,y,o,k,s,w,r;if((n===null||n==="")&&b!="link")return n;u=this.format.substr(this.format.indexOf(":")+1);switch(b){case"date":return t.isdate(n)?t.datestr(n,u):n;case"bool":return n=="1"?'<span class="icon icon-ok"><\/span>':"";case"action":return t.format('<a href="javascript:void()" class="grid" onclick="{0}(\''+n.replace(/\\/g,"\\\\")+"','"+i.id+'\')" title="{1}">',u.split("="))+n+"<\/a>";case"link":if(f=t.objstr(u,i),f.substr(0,1)==","&&(f=f.substr(1)),n&&n.substr(0,1)==","&&(n=n.substr(1)),c=f.replace(/=,/g,"=").split("|"),c.length>1){for(l=n||"",r=0;r<c.length;r++)if(e=c[r].split("="),e[1]&&e[1]!="null")if(a=e[1].split(","),a.length>1)for(h=0;h<a.length;h++)l+=' <a href="'+a[h]+'">'+e[0]+(h+1).toString()+"<\/a>";else l+=' <a href="'+e[1]+'">'+e[0]+"<\/a>";return l}return n&&f!="null"?'<a target="_blank" href="'+f+'">'+n+"<\/a>":n;case"href":return(n.substr(0,1)==","&&(n=n.substr(1)),v=u.split("|"),v.length>1)?'<a href="'+AX.format(v[1],n)+'">'+v[0]+"<\/a>":'<a target="_blank" href="'+n+'">'+u+"<\/a>";case"icon":return'<span class="icon '+n+'"><\/span>';case"text":return n.replace(/\r\n/g,"<br/>");case"button":for(p="",y=n.split(","),r=0;r<y.length;r++)o=y[r].split("=")[0],k=y[r].split("=")[1],p+=t.format("<a class=\"easyui-linkbutton aceui\" data-options=\"iconCls:'fa fa-{0}',text:'{5}'\" onclick=\"AX.gridAct('{4}','{1}','{3}')\" title=\"{2}\"><\/a>",o.split("_").length>1?o.split("_")[1]:o,o.split("_")[0],k,i.id.replace(/\\/g,"\\\\"),u,o.split("_").length>2?o.split("_")[2]:"");return p;case"attach":for(s=n.split(","),w="",r=1;r<s.length;r++)w+=t.format('<div class="lh20"><a href="{0}{1}" target="_blank" title="{2}">{3}{2}<\/a><\/div>',s[r].substr(0,4)=="http"?"":t.opts.root,s[r],t.filename(s[r]).substr(11),s.length>2?r+".":"");return w;case"qrcode":return t.format('<img src="/api/draw/getqrcode?text={0}" />',n);case"tip":return t.format('<a href="javascript:;" class="easyui-tooltip" data-options="content:$(\'<div><\/div>\'),onUpdate:{1}">{0}<\/a>',n,u);case"size":return t.filesize(n);default:return n}},dialog:function(n,i,r,u,f,e){typeof u=="undefined"&&(u=t.opts.w);typeof f=="undefined"&&(f=t.opts.h);i.substr(0,1)!="/"&&(i=t.path(i));var h=r==null?null:[{text:"确定",iconCls:"fa fa-check",handler:function(){$("iframe",o).get(0).contentWindow.onSubmit(function(){r.apply(this,arguments)||s.dialog("destroy")})}},{text:"取消",iconCls:"fa fa-close",handler:function(){e&&e.apply(this,arguments);t.dlgClose($("iframe",o).get(0).contentWindow,s)}}],o=window.top.$('<div class="dialog"><\/div>'),s=o.dialog({width:u,height:f,modal:!0,resizable:!0,title:n,maximizable:!0,onOpen:function(){$("iframe",o).attr("src",i)},content:'<iframe frameborder="0" style="width:100%;height:100%;margin:0px;padding:0px"><\/iframe>',onBeforeClose:function(){return t.dlgClose($("iframe",o).get(0).contentWindow,s)},buttons:h})},dclose:function(){t.dlgClose(window,window.parent.$(".dialog").last())},dlgClose:function(n,t){return n._modified&&confirm("数据已经修改，确定关闭窗口？")?t.dialog("destroy"):n._modified||t.dialog("destroy"),!1},root:"/",ok:function(n){typeof n=="string"?$.messager.info({msg:n}):$.messager.info({msg:"操作成功！"})},error:function(n){typeof n=="string"?$.messager.error({msg:n}):$.messager.error({msg:"操作失败！"})},okcall:function(n){$.messager.alert("提示","操作成功！","info",n)},ajaxerror:function(n){try{var t=n.responseJSON.error_description||n.responseJSON.error;$.messager.error({msg:t})}catch(i){$.messager.error({msg:n.status+"："+n.statusText})}},ajax:function(n){n.success=n.success||function(t){n.cb&&n.cb(t)};(n.type=="post"||n.type=="put")&&(n.data=JSON.stringify(n.data),n.dataType=n.dataType||"json",n.contentType=n.contentType||"application/json");n.error=n.error||this.ajaxerror;$.ajax(n)},api:function(n){var i=t.format("{0}api/{1}",t.opts.root,n.api);return n.ds&&(i=t.aurl(i,"app",t.opts.app),i=t.aurl(i,"ds",n.ds)),n.q&&(i+=i.indexOf("?")>0?"&":"?",i+=n.q),i},ext:function(n){var t=n.lastIndexOf(".");return t>0?n.substring(t):""},filename:function(n){var t=n.lastIndexOf("/");return t>0?n.substring(t+1):n},filesize:function(n){return n<1048576?(n/1024).toFixed(2)+"KB":n==1048576?"1MB":n>1048576&&n<1073741824?(n/1048576).toFixed(2)+"MB":n>1048576&&n==1073741824?"1GB":n>1073741824&&n<1099511627776?(n/1073741824).toFixed(2)+"GB":">1TB"},len:function(n){for(var t=0,i=0;i<n.length;i++,t++)n[i].match(/[^x00-xff]/ig)!=null&&t++;return t},now:function(){return new Date},tick:function(){return Date.parse(new Date)/1e3},pad:function(n,t,r,u){if(n.length<r){var f="";for(i=1;i<=r-n.length;i++)f+=t;return u?f+n:n+f}return n},format:function(){var n=arguments;return n.length<1?null:n[0].replace(/\{(\d+)(:(0{2,}))?\}/g,function(t,i){var f=t.indexOf(":"),r=$.isArray(n[1])?n[1][i].toString():n[++i].toString(),u;return f<0?r:(u=t.substring(f+1,t.length-1),u.length<r.length)?r:u.substr(0,u.length-r.length)+r})},aurl:function(n,t,i,r){var u=n.indexOf(t+"="),f;return u>0?(f=n.indexOf("&",u),f>u?n.replace(n.substr(u,f-u),t+"="+i):n.substr(0,u)+t+"="+i):r||n.indexOf("?")>0?n+"&"+t+"="+i:n+"?"+t+"="+i},objstr:function(n,t){return t?n.replace(/\{([^\d\{\}]+)([\w\_]+)?\}/g,function(n,i){return t[i]}):n},rndstr:function(n){var t;n=n||32;var i="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",u=i.length,r="";for(t=0;t<n;t++)r+=i.charAt(Math.floor(Math.random()*u));return r},tohex:function(n,i){var r=typeof n=="number"?n:parseInt(n);return t.pad(r.toString(16).toUpperCase(),"0",i,1)},fromhex:function(n){return parseInt(n,16)},isdate:function(n){var i=t.dateobj(n);return!isNaN(i)||!isNaN(d2)},date:function(n){return t.datestr(t.now,n)},dateobj:function(n){var t=n.match(/\d+/g);return new Date(t[0],t[1]-1,t[2],t[3]||0,t[4]||0,t[5]||0)},datestr:function(n,i){return typeof n=="string"&&(n=t.dateobj(n)),i.replace(/"[^"]*"|'[^']*'|\b(?:d{1,4}|M{1,4}|yy(?:yy)?|([hHmstT])\1?|[lLZ])\b/g,function(i){switch(i){case"d":return n.getDate();case"dd":return t.format("{0:00}",n.getDate());case"ddd":return $.fn.calendar.defaults.weeks[n.getDay()];case"dddd":return"星期"+$.fn.calendar.defaults.weeks[n.getDay()];case"M":return n.getMonth()+1;case"MM":return t.format("{0:00}",n.getMonth()+1);case"MMM":return $.fn.calendar.defaults.months[n.getMonth()].replace("月","");case"MMMM":return $.fn.calendar.defaults.months[n.getMonth()];case"yy":return String(n.getFullYear()).substr(2);case"yyyy":return n.getFullYear();case"h":return n.getHours()%12||12;case"hh":return t.format("{0:00}",n.getHours()%12||12);case"H":return n.getHours();case"HH":return t.format("{0:00}",n.getHours());case"m":return n.getMinutes();case"mm":return t.format("{0:00}",n.getMinutes());case"s":return n.getSeconds();case"ss":return t.format("{0:00}",n.getSeconds());case"l":return t.format("{0:000}",n.getMilliseconds(),3);case"L":var r=n.getMilliseconds();return r>99&&(r=Math.round(r/10)),t.format("{0:00}",r);case"tt":return n.getHours()<12?"am":"pm";case"TT":return n.getHours()<12?"AM":"PM";case"Z":return n.toUTCString().match(/[A-Z]+$/);default:return i.substr(1,i.length-2)}})},iframe:{resolution:200,iframes:[],interval:null,Iframe:function(){this.element=arguments[0];this.cb=arguments[1];this.hasTracked=!1},track:function(n,t){if(this.iframes.push(new this.Iframe(n,t)),!this.interval){var i=this;this.interval=setInterval(function(){i.checkClick()},this.resolution)}},checkClick:function(){var t,n;if(document.activeElement){t=document.activeElement;for(n in this.iframes)t===this.iframes[n].element?this.iframes[n].hasTracked==!1&&(this.iframes[n].cb.apply(window,[]),this.iframes[n].hasTracked=!0):this.iframes[n].hasTracked=!1}}}};n.AX=t}(window);$(function(){$.aceui&&$.aceui.auto&&$.aceui.parse();AX.tfocus()}),function(n){var t={wxRun:function(){var n=navigator.userAgent.toLowerCase();return n.indexOf("micromessenger")!=-1},wxUrl:function(){var n=t.aurl(w.location.href,"t",t.tick());w.history.replaceState(null,null,n)},wxInit:function(n){if(wx.config({beta:!0,debug:n.debug,appId:n.appId,timestamp:n.timestamp,nonceStr:n.nonce,signature:n.signature,jsApiList:n.jsApi}),n.resetUrl){var i=t.aurl(w.location.href,"t",n.timestamp);history.replaceState(null,null,i)}},wxOk:function(t){n.toptip(t||"操作成功",2e3,"success")},wxFail:function(t){n.toptip(t||"操作失败",2e3,"error")},wxWarn:function(t){n.toptip(t,2e3,"warning")},wxError:function(n){try{var i=n.responseJSON.error_description||n.responseJSON.error;t.wxFail(i)}catch(r){t.wxWarn(n.status+"："+n.statusText)}},wxScan:function(n){wx.scanQRCode({needResult:1,scanType:["qrCode"],success:function(t){n(t.resultStr)}})},wxWiFi:function(n){wx.invoke("configWXDeviceWiFi",{},function(i){i.err_msg=="configWXDeviceWiFi:ok"?n():i.err_msg=="configWXDeviceWiFi:cancel"?t.wxWarn("配网已取消！"):t.wxFail("配网失败，请确认已按配网要求进行操作！")})},wxMap:function(n,t,i,r,u){wx.openLocation({latitude:n,longitude:t,name:i,address:r,scale:14,infoUrl:u||null})},wxLoc:function(n,i){wx.getLocation({type:"wgs84",success:function(t){n(t.longitude,t.latitude)},cancel:i||function(){t.wxWarn("获取定位失败，用户拒绝授权！")}})},wxPage:function(){var r=!1,u=!0,i=n(".page"),h=n(".page .bd"),o='<i class="weui-loading"><\/i><span class="weui-loadmore__tips">正在加载<\/span>',s='<span class="weui-loadmore__tips">已无更多数据啦<\/span>',t=new Function("return {"+n("pager").attr("data-options")+"}")(),f=function(){i.infinite().find(".weui-loadmore").html(o)},e=function(){i.destroyInfinite().find(".weui-loadmore").html(s)};t.pageNumber==t.pageCount?e():f();i.pullToRefresh().on("pull-to-refresh",function(){n.get(w.location.href,function(t){n(".weui-photo-browser-modal").remove();n(".weui-cells").replaceWith(n(t).find(".weui-cells"));i.pullToRefreshDone();u||f()})});i.on("infinite",function(){if(!r&&(r=!0,t=new Function("return {"+n("pager").attr("data-options")+"}")(),t.pageNumber<t.pageCount)){var i=AX.aurl(w.location.href,"page",t.pageNumber+1);n.get(i,function(i){n("pager").replaceWith(n(i).find(".weui-cells").children());t.pageNumber+1==t.pageCount&&(u=!1,e());r=!1})}})},wxPhoto:function(t){var i=n(event.srcElement).closest(".weui-cell"),r;i.length||(i=n(event.srcElement).parent());r=i.data("photoBrowser");r||(r=n.photoBrowser({items:i.attr("data-photos").split(",")}),i.data("photoBrowser",r));r.open(t)},setUser:function(n,i){t.ajax({url:t.api({api:"auth/putuser"}),data:n,type:"put",cb:function(){t.wxOk("修改成功！");i()}})},setUid:function(i,r){i==""&&n.prompt({title:"设置登录名",text:"登录名由数字和字母组成，20个字符以内，设置成功后不能再次修改！",input:"登录名",empty:!1,onOK:function(n){n.length<20?t.setUser({loginname:n},function(){r(n)}):t.wxWarn("登录名不能超过20个字符！")}})},setNik:function(i,r){n.prompt({title:"设置昵称",text:"昵称不能超过10个字符，可以再改！",input:i,empty:!1,onOK:function(n){n.length<20?t.setUser({nickname:n},function(){r(n)}):t.wxWarn("昵称不能超过20个字符！")}})}};n.extend(AX,t)}(jQuery);